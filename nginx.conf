server {
  listen 80;
  listen [::]:80;

  location / {
      auth_basic "Restricted Area";
      auth_basic_user_file /etc/nginx/.htpasswd;
      resolver 8.8.8.8;
      set $target $http_x_proxy_to;
      proxy_pass http://$target$uri;
  }
}
