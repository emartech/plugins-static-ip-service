limit_req_zone $binary_remote_addr zone=ratelimit:10m rate=10r/s;

server {
  listen 8090;
  
  location / {
      limit_req zone=ratelimit;

      auth_basic "Restricted Area";
      auth_basic_user_file /etc/nginx/.htpasswd;

      resolver 127.0.0.11;

      set $proxy_base_url $http_x_proxy_base_url;

      proxy_set_header Authorization $http_x_proxy_authorization;

      proxy_pass $proxy_base_url$uri$is_args$args;
  }
}
